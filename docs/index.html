<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <title>Microservices lieben Azure Container Apps | Jan Stamer</title>

  <link rel="stylesheet" href="./assets/node_modules/reveal.js/dist/reset.css" />
  <link rel="stylesheet" href="./assets/node_modules/reveal.js/dist/reveal.css" />
  <link rel="stylesheet" href="./themes/corporate.css" id="theme" />

  <!-- Theme used for syntax highlighted code -->
  <link rel="stylesheet" href="./themes/tomorrow-night.css" id="highlight-theme" />
  <link href="./assets/tailwind.min.css" rel="stylesheet" />
</head>

<body>
  <div class="reveal">
    <div class="slides">
      <section data-background-image="./themes/Pattern-11-outline.svg" data-background-size="400px"
        data-background-repeat="repeat" data-background-opacity=".15">
        <h1>Microservices lieben Azure Container Apps <br>üíù</h1>
        <aside class="notes">
        </aside>
      </section>
      <section>
        <section data-background-image="./themes/timelab-sWOvgOOFk1g-unsplash.jpg" >
          <h1 class="cross-white fragment">Unser k8s Traum ...</h1>
        </section>
        <section data-background-image="./themes/premium_photo-1661644823131-7de42f3c04ab.avif" >
          <h1 class="cross-white">... ich im Projekt</h1>
        </section>
        <section data-background-image="./themes/Pattern-29-outline.svg" data-background-size="400px"
          data-background-repeat="repeat" data-background-opacity=".15">
          <h1>Es war einmal ...</h1>
        </section>        
        <section>
          <h2>Projekte bei crossnative</h2>
          <ul>
            <li class="fragment">Standardisierte Software Projekte</li>
            <li class="fragment">Fokus auf Anwendungen nicht Infrastruktur</li>
            <li class="fragment">Launchpad Stack mit Spring, Postgres, ...</li>
            <li class="fragment">Cloud Umgebung von Au√üen verf√ºgbar</li>
            <li class="fragment">Container basiert und k8s nah</li>
            <li class="fragment">Pay-per-Use</li>
          </ul>
          <div class="fragment box-content rounded p-6 border-4 transform -rotate-12 text-black"
          style="position: relative; top: -180px; background-color: #dbd4d4;">
          Azure Container Apps ! üöÄ
          </div>
        </section>
      </section>
      <section>
        <section>
          <h2 class="cross-white" style="margin-bottom: 1em;">       
            <img src="themes/aca_logo.png" width="300" style="display: inline;"/> Azure Container Apps
          </h2>
              <ul>
                <li class="fragment">verwaltete Serverless Container Plattform</li>
                <li class="fragment">flexibel Skalierbar (Zero to Hero)</li>
                <li class="fragment">"mini" k8s mit 1 Namespace</li>
                <li class="fragment">basiert auf Azure Kubernetes Plattform</li>
                <li class="fragment">Kubernetes ohne Server</li>
                <li class="fragment">KEDA Autoscaling, Replicas und Ingress von Kubernetes</li>
              </ul>
        </section>
        <section>
          <h2 class="cross-white">
            <img src="themes/aca_logo.png" width="200" style="display: inline;"/> 
            Azure Container Apps <br/>&nbsp; bei crossnative
          </h2>
          <ul>
            <li class="fragment">nutzen ACA seit 2 Jahren</li>
            <li class="fragment">erst nur f√ºr Test und Entwicklung</li>
            <li class="fragment">produktiver Betrieb mehrerer Anwendungen</li>
          </ul>
        </section>
    </section>
      <section>
        <section data-background-image="./themes/Pattern-13-outline.svg" data-background-size="400px"
        data-background-repeat="repeat" data-background-opacity=".15">
          <h1 class="cross-red">Freddys BBQ <br/><span class="fragment">Basis Setup</span> <br/>üçñ</h1>
        </section>
        <section >
          <h2 class="cross-red">Freddys BBQ _ √úbersicht</h2>
          <img src="themes/bbq-arch.png" width="460"/>
        </section>
        <section data-background-image="themes/growtika-ZfVyuV8l7WU-unsplash.jpg" 
         data-background-opacity=".2">
          <h2 class="cross-red" >Microservices mit Azure Container Apps</h2>
              <ol>
                <li class="fragment">ein gemeinsames Container App Environment</li>
                <li class="fragment">eine Container App je Microservice</li>
                <li class="fragment">App Insights und Log Analytics gemeinsam </li>
              </ol>
        </section>
        <section>
          <h2 class="cross-red">Freddys BBQ _ Infrastruktur</h2>
          <img src="themes/bbq-aca-overview-1.png" width="650"/>
        </section>
        <section >
          <h2 class="cross-red">Freddys BBQ _ Infrastruktur</h2>
          <img src="themes/bbq-aca-overview-2.png" width="650"/>
        </section>
        <section>
          <h2 class="cross-red" >Container App Environment</h2>
          <img src="themes/bbq-aca-container-env.png" width="540"/>
        </section>
        <section>
          <h2 class="cross-red" >Freddys Container Apps</h2>
          <img src="themes/aca-cae-screenshot.png" width="1400"/>
        </section>
        <section>
          <h2 class="cross-red" >Shop Frontend Container App</h2>
          <img src="themes/aca-app-shop-frontend-screenshot.png" width=1400"/>
        </section>
        <section>
          <h2 class="cross-red">Demo BBQ bestellen _ Teil 1 üöß</h2>
        </section>
        <section data-transition="none">
          <h2 class="cross-red">BBQ Bestellen Ablauf #1</h2>
          <img src="themes/bbq_order_2.png" width="54%" style="position: relative; left: -28px;"/>
        </section>
        <section data-transition="none">
          <h2 class="cross-red">BBQ Bestellen Ablauf #3</h2>
          <img src="themes/bbq_order_3.png" width="64%" style="position: relative; left: -66px;"/>
        </section>
        <section data-transition="none">
          <h2 class="cross-red">BBQ Bestellen Ablauf #4</h2>
          <img src="themes/bbq_order_4.png"width="72%" style="position: relative; left: -36px;"/>
        </section>
        <section>
          <h2 class="cross-red">Demo BBQ bestellen _ Teil 2 üöß</h2>
        </section>
      </section>
      <section>
        <section data-background-image="./themes/Pattern-29-outline.svg" data-background-size="400px"
        data-background-repeat="repeat" data-background-opacity=".15">
          <h1 class="cross-blue">Infrastruktur mit Terraform</h1>
        </section>
        <section>
          <h2>Container Apps Basis</h2>
          <pre style="font-size: 37%"><code data-trim data-line-numbers="1-5|7-14|16-23|25-31|" class="terraform">
            /* 1. ResourceGroup */
            resource "azurerm_resource_group" "freddy" {
              name     = "rg-freddy-dev-westeu"
              location = "West Europe"
            }
            
            /* 2. Log Analytics Workspace */
            resource "azurerm_log_analytics_workspace" "app_log_analytics" {
              name                = "log-freddy-dev-westeu"
              location            = azurerm_resource_group.freddy.location
              resource_group_name = azurerm_resource_group.freddy.name
              sku                 = "PerGB2018"
              retention_in_days   = 30
            }
            
            /* 3. Application Insights */
            resource "azurerm_application_insights" "freddy_appinsights" {
              name                = "appi-freddy-dev-westeu"
              location            = azurerm_resource_group.freddy.location
              resource_group_name = azurerm_resource_group.freddy.name
              workspace_id        = azurerm_log_analytics_workspace.app_log_analytics.id
              application_type    = "web"
            }
            
            /* 4. Container App Environment */
            resource "azurerm_container_app_environment" "cae" {
              name                       = "cae-freddy-dev-westeu"
              location                   = azurerm_resource_group.freddy.location
              resource_group_name        = azurerm_resource_group.freddy.name
              log_analytics_workspace_id = azurerm_log_analytics_workspace.app_log_analytics.id
            }
            </code></pre>
        </section>
        <section>
          <h2>Container App <span class="cross-white">Kitchen</span> üë©‚Äçüç≥</h2>
          <pre style="font-size: 42%"><code  data-trim data-line-numbers="1-5,27|7-16|18-25|" class="terraform">
            resource "azurerm_container_app" "kitchen" {
              name                         = "kitchen"
              container_app_environment_id = azurerm_container_app_environment.cae.id
              resource_group_name          = azurerm_resource_group.freddy.name
              revision_mode                = "Single"
            
              template {
                container {
                  name   = "kitchen"
                  image  = "ghcr.io/remast/kitchen-aca:0.1.0"
                  cpu    = 0.25
                  memory = "0.5Gi"
                }
                min_replicas = 0
                max_replicas = 1
              }

              ingress {
                target_port      = 8070
                traffic_weight {
                  latest_revision = true
                  percentage      = 100
                }
              }
            
            }
            </code></pre>
        </section>
        <section>
          <h2>Container App <span class="cross-yellow">Order</span> ü§ë</h2>
          <pre style="font-size: 35%"><code  data-trim data-line-numbers="1-5,33|7-12,21-24|13-20|" class="terraform">
            resource "azurerm_container_app" "order" {
              name                         = "order"
              container_app_environment_id = azurerm_container_app_environment.cae.id
              resource_group_name          = azurerm_resource_group.freddy.name
              revision_mode                = "Single"
            
              template {
                container {
                  name   = "order"
                  image  = "ghcr.io/remast/order-aca:0.1.0"
                  cpu    = 0.5
                  memory = "1Gi"
                  env {
                    name  = "DELIVERY_SERVICE_URL"
                    value = "http://delivery"
                  }
                  env {
                    name  = "KITCHEN_SERVICE_URL"
                    value = "http://kitchen"
                  }
                }
                min_replicas = 0
                max_replicas = 1
              }
            
              ingress {
                target_port      = 8060
                traffic_weight {
                  latest_revision = true
                  percentage      = 100
                }
              }            
            }
            </code></pre>
        </section>
        <section>
          <h2>Container App <span class="cross-red">Shop Frontend</span> üè™</h2>
          <pre style="font-size: 37%"><code  data-trim data-line-numbers="1-5,27,7-16|18-19,21-25|20,29-31|" class="terraform">
            resource "azurerm_container_app" "shop-frontend" {
              name                         = "shop-frontend"
              container_app_environment_id = azurerm_container_app_environment.cae.id
              resource_group_name          = azurerm_resource_group.freddy.name
              revision_mode                = "Single"
            
              template {
                container {
                  name   = "shop-frontend"
                  image  = "ghcr.io/remast/shop-frontend-aca:0.2.0"
                  cpu    = 0.25
                  memory = "0.5Gi"
                }
                min_replicas = 0
                max_replicas = 1
              }

              ingress {
                target_port      = 4200
                external_enabled = true
                traffic_weight {
                  latest_revision = true
                  percentage      = 100
                }
              }
            
            }

            output "shop_frontend_fqdn" {
              value = azurerm_container_app.shop-frontend.latest_revision_fqdn
            }
            </code></pre>
        </section>
        <section>
          <h2>Terraform ausf√ºhren</h2>
          <pre style="font-size: 37%"><code  data-trim data-line-numbers="1|3-28|" class="java">
            >_ terraform apply

            azurerm_resource_group.freddy: Refreshing state...
            azurerm_container_app_environment.cae: Refreshing state...
            azurerm_container_app.delivery: Refreshing state...
            azurerm_container_app.kitchen: Refreshing state...
            azurerm_container_app.shop-frontend: Refreshing state...
            azurerm_container_app.order: Refreshing state...
            
            Terraform will perform the following actions:
            
              # azurerm_container_app.order will be updated in-place
              ~ resource "azurerm_container_app" "order" {
                  ~ template {
                      ~ container {
                          ~ memory = "0.5Gi" -> "1Gi"
                        }
                    }
                }
            
            Plan: 0 to add, 1 to change, 0 to destroy.
            
            azurerm_container_app.order: Modifying...
            azurerm_container_app.order: Modifications complete after 17s
            Apply complete! Resources: 0 added, 1 changed, 0 destroyed.
            
            Outputs:
            shop_frontend_fqdn = "shop-frontend-03.victorious-3fb.westeurope.azurecontainerapps.io"            
          </code></pre>
        </section>
        <section>
          <h2 class="cross-blue">Demo Terraform üöß</h2>
        </section>
      </section>
      <section>
        <section data-background-image="./themes/Pattern-32-outline.svg" data-background-size="400px"
        data-background-repeat="repeat" data-background-opacity=".15">
        <h1 class="cross-yellow">Freddys BBQ <br/>in Produktion <br/>üçñ</h1>
        </section>
        <section>
          <h2 class="cross-yellow">In Produktion</h2>
          <ul>
            <li class="fragment">Probes f√ºr Health und Startup</li>
            <li class="fragment">Blue/Green Deployments mit Revisionen</li>
            <li class="fragment">Passw√∂rter aus Secrets</li>
            <li class="fragment">Metriken (CPU Usage, Memory Working Set Bytes, Requests) und Logs</li>
            <li class="fragment">Skalieren mit KEDA</li>
            <li class="fragment">Workload Profiles</li>
          </ul>
        </section>
        <section>
          <h2>Probes f√ºr Health und Startup üë©‚Äçüç≥</h2>
          <pre style="font-size: 41%"><code  data-trim data-line-numbers="1,28|9-25|" class="terraform">
            resource "azurerm_container_app" "kitchen" {
              template {
                container {
                  name   = "kitchen"
                  image  = "ghcr.io/remast/kitchen-aca:0.1.0"
                  cpu    = 0.25
                  memory = "0.5Gi"

                  startup_probe {
                    interval_seconds        = 5
                    failure_count_threshold = 3
                    port                    = 8070
                    path                    = "/health/readiness"
                    transport               = "HTTP"
                  }
                  readiness_probe {
                    port      = 8070
                    path      = "/health/readiness"
                    transport = "HTTP"
                  }
                  liveness_probe {
                    port      = 8070
                    path      = "/health/liveness"
                    transport = "HTTP"
                  }
                }
              }
            }
            </code></pre>
        </section>
        <section>
          <h2>Passw√∂rter aus Secrets ü§ë</h2>
          <pre style="font-size: 41%"><code  data-trim data-line-numbers="1-2,29|4-7|4-7,24-27|" class="terraform">
            resource "azurerm_container_app" "order" {
              name = "order"
            
              secret {
                name  = "secret-api-key"
                value = "***shush***"
              }
            
              template {
                container {
                  name   = "order"
                  image  = "ghcr.io/remast/order-aca:0.1.0"
                  cpu    = 0.5
                  memory = "1Gi"

                  env {
                    name  = "DELIVERY_SERVICE_URL"
                    value = "http://delivery"
                  }
                  env {
                    name  = "KITCHEN_SERVICE_URL"
                    value = "http://kitchen"
                  }
                  env {
                    name        = "SECRET_API_KEY"
                    secret_name = "secret-api-key"
                  }
                }
              }
            }
            </code></pre>
        </section>
        <section>
          <h2>Blue/Green Deployments üö¶</h2>
          <img src="themes/aca_bluegreen.png" />
          <ul>
            <li class="fragment">sdf</li>
          </ul>
        </section>
        <section>
          <h2>Workload Profiles</h2>
        </section>
      </section>
      <section>
        <section data-background-image="./themes/Pattern-12-full.svg" data-background-size="400px"
        data-background-repeat="repeat" data-background-opacity=".15">
          <h1>Was ACA noch kann</h1>
        </section>
        <section>
          <h2>Was ACA noch kann</h2>
          <ul>
            <li class="fragment">Jobs</li>
            <li class="fragment">Ereignisse</li>
            <li class="fragment">Authentifizierung</li>
            <li class="fragment">SSL Zertifikate und mTLS</li>
          </ul>
        </section> 
      </section>
      <section>
        <section data-background-image="./themes/Pattern-13-outline.svg" data-background-size="400px"
        data-background-repeat="repeat" data-background-opacity=".15">
        <h2 class="cross-white" style="margin-bottom: 1em;">Azure Container Apps</h2>
        <div class="grid grid-cols-12 gap-1 content-start" style="font-size: 75%;">
          <div class="col-span-6 fragment">
            <h3 class="cross-white">Function-as-a-Service</h3>
            <ol>
              <li class="cross-yellow">
                Google Cloud Run Function
                <ul>
                  <li>Go Function Framework</li>
                  <li>HTTP Handler Function</li>
                  <li>JSON und Structs</li>
                  <li>Fehler</li>
                  <li>HTTP Handler Test</li>
                </ul>
              </li>
              <li class="cross-blue">
                Azure Function App
                <ul>
                  <li>Umgebungsvariablen</li>
                  <li>HTTP Router/Server</li>
                  <li>Lokale Ausf√ºhrung</li>
                </ul>
              </li>
            </ol>
          </div>
          <div class="col-span-6 fragment">
            <h3 class="cross-white">Serverless Containers</h3>
            <ol start="3">
              <li class="cross-yellow">
                Google Cloud Run
                <ul>
                  <li>Docker Image</li>
                  <li>HTTP Router/Server</li>
                </ul>
              </li>
              <li class="cross-blue">
                Azure Container Apps
                <ul>
                  <li>Health Check</li>
                </ul>
              </li>
            </ol>
          </div>
        </div>
        </section>
      </section>
      <section>
        <h2 style="font-size: 170%">3 Gr√ºnde f√ºr <br/> Azure Container Apps</h2>
        <ol style="font-size: 130%; list-style-type:none;">
          <li class="fragment">üèÉ Schnell</li>
          <li class="fragment">‚òØÔ∏è Einfach</li>
          <li class="fragment">üöÇ M√§chtig</li>
        </ol>
    </section>
      <section>
        <div class="grid grid-cols-2 gap-1 text-left">
          <div>
            <img src="./themes/JanStamer_profil_schmal.png" class="object-scale-down h-80" style="margin-top: 0" />
          </div>
          <div>
            <h2 style="margin-bottom: 0">Jan Stamer</h2>
            <div class="mb-10">
              <a href="mailto:jan.stamer@crossnative.com" style="font-size: 85%">jan.stamer@crossnative.com</a>
            </div>

            <div class="grid grid-cols-4 gap-1 text-left">
              <div>
                <a href="https://www.linkedin.com/in/jan-stamer">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="72" height="72">
                    <path fill="none" d="M0 0h24v24H0z" />
                    <path
                      d="M6.94 5a2 2 0 1 1-4-.002 2 2 0 0 1 4 .002zM7 8.48H3V21h4V8.48zm6.32 0H9.34V21h3.94v-6.57c0-3.66 4.77-4 4.77 0V21H22v-7.93c0-6.17-7.06-5.94-8.72-2.91l.04-1.68z"
                      fill="rgba(255,255,255,1)" />
                  </svg>
                </a>
              </div>
              <div>
                <a href="https://github.com/remast/">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="72" height="72">
                    <path fill="none" d="M0 0h24v24H0z" />
                    <path
                      d="M12 2C6.475 2 2 6.475 2 12a9.994 9.994 0 0 0 6.838 9.488c.5.087.687-.213.687-.476 0-.237-.013-1.024-.013-1.862-2.512.463-3.162-.612-3.362-1.175-.113-.288-.6-1.175-1.025-1.413-.35-.187-.85-.65-.013-.662.788-.013 1.35.725 1.538 1.025.9 1.512 2.338 1.087 2.912.825.088-.65.35-1.087.638-1.337-2.225-.25-4.55-1.113-4.55-4.938 0-1.088.387-1.987 1.025-2.688-.1-.25-.45-1.275.1-2.65 0 0 .837-.262 2.75 1.026a9.28 9.28 0 0 1 2.5-.338c.85 0 1.7.112 2.5.337 1.912-1.3 2.75-1.024 2.75-1.024.55 1.375.2 2.4.1 2.65.637.7 1.025 1.587 1.025 2.687 0 3.838-2.337 4.688-4.562 4.938.362.312.675.912.675 1.85 0 1.337-.013 2.412-.013 2.75 0 .262.188.574.688.474A10.016 10.016 0 0 0 22 12c0-5.525-4.475-10-10-10z"
                      fill="rgba(255,255,255,1)" />
                  </svg>
                </a>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section>
        <h2>Microservices lieben <br/>Azure Container Apps</h2>
        <img src="./themes/qr-code.png" width=400"/>
      </section>
    </div>
  </div>

  <script src="./assets/node_modules/reveal.js/dist/reveal.js"></script>
  <script src="./assets/node_modules/reveal.js/plugin/notes/notes.js"></script>
  <script src="./assets/node_modules/reveal.js/plugin/markdown/markdown.js"></script>
  <script src="./assets/node_modules/reveal.js/plugin/highlight/highlight.js"></script>
  <script src="./assets/node_modules/reveal.js/plugin/zoom/zoom.js"></script>
  <script>
    Reveal.initialize({
      transition: "slide",
      pdfSeparateFragments: false,
      navigationMode: "linear",
      dependencies: [
        { src: "./node_modules/reveal-plantuml/dist/reveal-plantuml.min.js" },
      ],
      hash: true,
      plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealZoom],
    });
  </script>
</body>
</html>